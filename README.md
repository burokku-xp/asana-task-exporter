# Asana Task Exporter

AsanaのタスクをExcelファイルにエクスポートするWindowsアプリケーションです。

## 特徴

- 🚀 **簡単操作**: GUIで直感的にタスクをエクスポート
- 📊 **Excel出力**: フィルタ・ソート機能付きExcelファイルを生成
- 🎨 **カスタムフィールド対応**: プロジェクト固有のカスタムフィールドも出力可能
- 🔒 **セキュア**: APIトークンを暗号化して安全に保存
- ⚡ **高速**: 大量のタスクも効率的に処理

## ダウンロード

最新版のexeファイルをダウンロード:

📥 **[AsanaTaskExporter.exe をダウンロード](https://github.com/YOUR_USERNAME/YOUR_REPO/raw/main/dist/AsanaTaskExporter.exe)**

> ⚠️ Windowsの警告が表示される場合は「詳細情報」→「実行」をクリックしてください

## 使い方

### 1. Asana APIトークンの取得

1. [Asana](https://app.asana.com/) にログイン
2. 右上のプロフィールアイコン → **マイ設定**
3. **アプリ** タブ → **個人用アクセストークン**
4. **新しいトークンを作成** をクリック
5. トークン名を入力して **トークンを作成**
6. 表示されたトークンをコピー（⚠️ この画面を閉じると二度と表示されません）

### 2. アプリケーションの設定

1. `AsanaTaskExporter.exe` を起動
2. **設定** ボタンをクリック
3. APIトークンを貼り付け
4. **接続テスト** で接続確認
5. プロジェクトを選択
6. エクスポートするフィールドを選択
7. **保存** をクリック

### 3. タスクのエクスポート

1. メイン画面で期間を選択
   - プリセット（過去7日/30日/90日）も利用可能
2. 完了状態を選択
   - **すべて**: 完了・未完了両方
   - **完了のみ**: 完了したタスクのみ
   - **未完了のみ**: 未完了のタスクのみ
3. **Excelにエクスポート** をクリック
4. 保存先を選択

## 出力されるデータ

### 基本フィールド
- タスク名
- 作成日時
- 更新日時
- 完了状態
- 担当者
- 期限日
- メモ

### カスタムフィールド
プロジェクトに設定されているカスタムフィールドも自動的に取得・出力されます。

## Excel機能

出力されたExcelファイルには以下の機能が含まれます:

- ✅ **オートフィルタ**: 各列でフィルタ・ソートが可能
- 🎨 **見やすいデザイン**: ヘッダー行の強調、交互行の背景色
- 📏 **統一された行高**: すべての行が見やすい高さに調整
- 🔒 **ヘッダー固定**: スクロールしてもヘッダー行が常に表示

## システム要件

- **OS**: Windows 10 / 11
- **メモリ**: 4GB以上推奨
- **ディスク空間**: 100MB以上

## トラブルシューティング

### アプリが起動しない
- Windows Defenderやセキュリティソフトが実行をブロックしている可能性があります
- 「詳細情報」→「実行」で起動してください

### API接続エラー
1. APIトークンが正しいか確認
2. インターネット接続を確認
3. Asanaのサービス状態を確認: https://status.asana.com/

### タスクが取得できない
- プロジェクトのアクセス権限を確認
- 日付範囲にタスクが存在するか確認

### カスタムフィールドが表示されない
- `REBUILD.bat` で最新版をビルドしてください
- APIトークンに十分な権限があるか確認

## ログファイル

問題が発生した場合は、実行ファイルと同じフォルダの `logs/` ディレクトリ内のログファイルを確認してください。

## 開発者向け

### ビルド方法

#### 必要なもの
- Python 3.13
- Git

#### セットアップ
```bash
# リポジトリをクローン
git clone https://github.com/YOUR_USERNAME/YOUR_REPO.git
cd AsanaExcel取得ツール

# 仮想環境を作成
python -m venv venv
venv\Scripts\activate

# 依存パッケージをインストール
pip install -r requirements.txt
pip install -r requirements-build.txt
```

#### ビルド
```bash
# Windowsでビルド
REBUILD.bat
```

ビルドされたexeファイルは `dist/AsanaTaskExporter.exe` に生成されます。

### プロジェクト構造
```
AsanaExcel取得ツール/
├── src/
│   ├── business/         # ビジネスロジック
│   ├── data/            # データモデルとAPI
│   ├── gui/             # GUIコンポーネント
│   └── utils/           # ユーティリティ
├── dist/                # ビルド成果物
├── build_no_hooks.spec  # PyInstallerビルド設定
├── REBUILD.bat          # ビルドスクリプト
└── README.md
```

## ライセンス

MIT License - 詳細は [LICENSE.txt](LICENSE.txt) を参照

## 貢献

プルリクエストを歓迎します！バグ報告や機能リクエストは [Issues](https://github.com/YOUR_USERNAME/YOUR_REPO/issues) で受け付けています。

## 更新履歴

### v1.0.0 (2025-10-06)
- ✨ 初回リリース
- 📊 Excelエクスポート機能
- 🎨 カスタムフィールド対応
- 🔒 APIトークン暗号化
- ⚡ オートフィルタ付きExcel出力
- 📏 完了状態フィルタ機能
